# Технические требования для первой фазы MVP Service Desk системы

Этот документ определяет технические требования для первой фазы разработки MVP (Minimum Viable Product) Service Desk системы. Он основан на архитектурном плане и включает в себя спецификации для всех ключевых компонентов системы.

## 1. Спецификации серверной части (Express.js, PostgreSQL)

### 1.1. Express.js

- **Фреймворк**: Express.js 4+
- **Язык программирования**: Node.js 18+
- **Основные функции**:
  - Обработка HTTP-запросов и ответов
  - Маршрутизация API
  - Middleware для обработки запросов (парсинг JSON, CORS, логирование)
  - Интеграция с PostgreSQL для хранения данных
  - Интеграция с JWT для аутентификации и авторизации
  - Интеграция с JIRA для синхронизации заявок
  - Интеграция с Active Directory (SAMBA) для авторизации сотрудников
  - Предоставление Open API Gateway для кастомных интеграций
- **Документация API**: Swagger (OpenAPI 3.0)
- **Логирование**: Winston
- **Тестирование**: Jest, Supertest

### 1.2. PostgreSQL

- **Версия**: PostgreSQL 12+
- **Функции**:
  - Хранение данных пользователей
  - Хранение заявок
  - Хранение refresh token'ов
  - Хранение конфигурации системы
- **Хостинг**: Локальный или облачный (например, AWS RDS, Google Cloud SQL)
- **Резервное копирование**: pg_dump, WAL-G
- **Мониторинг**: pg_stat_statements, Prometheus

## 2. Требования к клиентской части (React)

- **Фреймворк**: React 18+
- **Язык**: TypeScript
- **Управление состоянием**: Redux Toolkit
- **Стили**: CSS Modules или Styled Components
- **Маршрутизация**: React Router
- **HTTP-клиент**: Axios
- **Основные функции**:
  - Отображение интерфейса пользователя
  - Взаимодействие с Backend API через REST API
  - Аутентификация и авторизация пользователей
  - Создание, просмотр и управление заявками
  - Отображение статуса заявок
  - Интеграция с системой уведомлений

## 3. Спецификации Telegram бота

- **Библиотека**: node-telegram-bot-api
- **Взаимодействие с Backend**: REST API или Webhooks
- **Основные функции**:
  - Прием команд от пользователей
  - Создание заявок через Telegram
  - Просмотр статуса заявок
  - Уведомления о статусе заявок
- **Обработка команд**:
  - `/start` - приветствие и инструкции
  - `/create_ticket` - создание новой заявки
  - `/ticket_status` - просмотр статуса заявки
  - `/help` - помощь и поддержка

## 4. Требования к аутентификации и авторизации (JWT)

- **Библиотека**: jsonwebtoken
- **Алгоритм**: RS256 (асимметричный) или HS256 (симметричный)
- **Токены**:
  - **Access token**: срок действия 1 час
  - **Refresh token**: срок действия 7 дней
- **Хранение refresh token'ов**: В базе данных (PostgreSQL)
- **Функции**:
  - Выдача токенов при успешной аутентификации
  - Проверка валидности токенов
  - Обновление токенов
  - Отзыв токенов при выходе пользователя

## 5. Спецификации API (Swagger)

- **Интеграция**: swagger-jsdoc, swagger-ui-express
- **Документация**: Автоматически генерируется из JSDoc комментариев в коде
- **Доступ**: Доступен по маршруту /api-docs
- **Формат**: OpenAPI 3.0
- **Функции**:
  - Описание всех API endpoint'ов
  - Примеры запросов и ответов
  - Описание параметров и моделей данных
  - Возможность тестирования API прямо из интерфейса Swagger

## 6. Требования к интеграции с JIRA

- **API**: JIRA REST API
- **Аутентификация**: API token или OAuth
- **Функции**:
  - Создание заявок в JIRA
  - Обновление статуса заявок в JIRA
  - Синхронизация заявок между Service Desk и JIRA
- **Конфигурация**:
  - Настройки сервера JIRA
  - Учетные данные для подключения
  - Правила синхронизации (например, какие поля синхронизировать, как сопоставлять статусы)

## 7. Требования к интеграции с Active Directory (SAMBA)

- **Библиотека**: ldapjs или activedirectory
- **Протокол**: LDAP
- **Функции**:
  - Аутентификация пользователей через Active Directory
  - Получение информации о пользователях (имя, email, подразделение)
  - Синхронизация пользователей между Active Directory и Service Desk
- **Конфигурация**:
  - Настройки сервера AD (хост, порт, протокол)
  - Учетные данные для подключения (bind DN, пароль)
  - Базовый DN для поиска пользователей
  - Правила сопоставления атрибутов AD с полями пользователей в Service Desk